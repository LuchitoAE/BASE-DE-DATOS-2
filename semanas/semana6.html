<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Semana 6</title> <!-- Cambia X por el número de la semana -->
    <link rel="stylesheet" href="styles.css"> <!-- Estilo CSS compartido -->
    <link rel="stylesheet" href="semana6.css">
</head>
<body>
    <div class="page-container"> <!-- Contenedor general para centrar la página -->
        <header>
            <div class="container">
                <div class="left">
                    <a href="../index.html">INICIO</a>
                </div>
                <div class="right">
                    <a href="../examenfinal.html">Examen Final</a>
                    <a href="../libro/modulo1.html">Libro SQL Server</a>
                    <a href="../misdatos.html">Mis datos</a>
                    <a href="../curso.html">Curso</a>
                    <div class="dropdown">
                        <button class="dropbtn">Semanas</button>
                        <div class="dropdown-content">
                            <a href="../semanas/semana1.html">Semana 1</a>
                            <a href="../semanas/semana2.html">Semana 2</a>
                            <a href="../semanas/semana3.html">Semana 3</a>
                            <a href="../semanas/semana4.html">Semana 4</a>
                            <a href="../semanas/semana5.html">Semana 5</a>
                            <a href="../semanas/semana6.html">Semana 6</a>
                            <a href="../semanas/semana7.html">Semana 7</a>
                            <a href="../semanas/semana8.html">Semana 8</a>
                            <a href="../semanas/semana9.html">Semana 9</a>
                            <a href="../semanas/semana10.html">Semana 10</a>
                            <a href="../semanas/semana11.html">Semana 11</a>
                            <a href="../semanas/semana12.html">Semana 12</a>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        
        <main>
            <!-- Botones para seleccionar las consultas -->
            <div class="guide-buttons">
                <h2>Consultas avanzadas</h2>
                <button id="ConsultasBtn" class="guide-btn active">Consultas</button>
                <button id="ConsultasExternaBtn" class="guide-btn">Consultas multitablas (composición externa)</button>
                <button id="ConsultasInternaBtn" class="guide-btn">Consultas multitablas (composición interna)</button>
                <button id="ConsultasResumenBtn" class="guide-btn">Consultas resumen</button>
                <button id="SubconsultasBtn" class="guide-btn">Subconsultas</button>
            </div>
            
            <!-- tipo Consultas --> 
            <div id="Consultas" class="guide-section active">
                <h2>Consultas</h2>
                <div class="step">
                    <h3>1. Lista el primer apellido de todos los empleados</h3>
                    <pre><code>SELECT apePaterno FROM empleado;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/1.png" alt="pregunta 1">
                </div>
            
                <div class="step">
                    <h3>2. Lista el primer apellido de los empleados eliminando los apellidos que estén repetidos</h3>
                    <pre><code>SELECT DISTINCT apePaterno FROM empleado;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/2.png" alt="pregunta 2">
                </div>
            
                <div class="step">
                    <h3>3. Lista todas las columnas de la tabla empleado</h3>
                    <pre><code>SELECT * FROM empleado;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/3.png" alt="pregunta 3">
                </div>
            
                <div class="step">
                    <h3>4. Lista el nombre y los apellidos de todos los empleados</h3>
                    <pre><code>SELECT nombre, apePaterno, apeMaterno FROM empleado;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/4.png" alt="pregunta 4">
                </div>
            
                <div class="step">
                    <h3>5. Lista el código de los departamentos de los empleados que aparecen en la tabla empleado</h3>
                    <pre><code>SELECT codigo_departamento FROM empleado;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/5.png" alt="pregunta 5">
                </div>
            
                <div class="step">
                    <h3>6. Lista el código de los departamentos de los empleados eliminando los códigos que estén repetidos</h3>
                    <pre><code>SELECT DISTINCT codigo_departamento FROM empleado;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/6.png" alt="pregunta 6">
                </div>
            
                <div class="step">
                    <h3>7. Lista el nombre y apellidos de los empleados en una única columna</h3>
                    <pre><code>SELECT CONCAT(nombre, ' ', apePaterno, ' ', apeMaterno) AS NombreCompleto FROM empleado;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/7.png" alt="pregunta 7">
                </div>
            
                <div class="step">
                    <h3>8. Lista el nombre y apellidos de los empleados en una única columna, convirtiendo todos los caracteres en mayúscula</h3>
                    <pre><code>SELECT UPPER(CONCAT(nombre, ' ', apePaterno, ' ', apeMaterno)) AS NombreCompleto FROM empleado;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/8.png" alt="pregunta 8">
                </div>

                <div class="step">
                    <h3>9. Lista el nombre y apellidos de los empleados en una única columna, convirtiendo todos los caracteres en minúscula</h3>
                    <pre><code>SELECT LOWER(CONCAT(nombre, ' ', apePaterno, ' ', apeMaterno)) AS NombreCompleto FROM empleado;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/9.png" alt="pregunta 9">
                </div>
            
                <div class="step">
                    <h3>10. Lista el código de los empleados junto al nif, pero el nif deberá aparecer en dos columnas, una mostrará únicamente los dígitos del nif y la otra la letra</h3>
                    <pre><code>SELECT codigo, LEFT(dni, LEN(dni)-1) AS DigitosNIF, RIGHT(dni, 1) AS LetraNIF FROM empleado;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/10.png" alt="pregunta 10">
                </div>
            
                <div class="step">
                    <h3>11. Lista el nombre de cada departamento y el valor del presupuesto actual del que dispone</h3>
                    <pre><code>SELECT nombre, (presupuesto - gastos) AS PresupuestoActual FROM departamento;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/11.png" alt="pregunta 11">
                </div>
            
                <div class="step">
                    <h3>12. Lista el nombre de los departamentos y el valor del presupuesto actual ordenado de forma ascendente</h3>
                    <pre><code>SELECT nombre, (presupuesto - gastos) AS PresupuestoActual FROM departamento ORDER BY PresupuestoActual ASC;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/12.png" alt="pregunta 12">
                </div>
            
                <div class="step">
                    <h3>13. Lista el nombre de todos los departamentos ordenados de forma ascendente</h3>
                    <pre><code>SELECT nombre FROM departamento ORDER BY nombre ASC;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/13.png" alt="pregunta 13">
                </div>
            
                <div class="step">
                    <h3>14. Lista el nombre de todos los departamentos ordenados de forma descendente</h3>
                    <pre><code>SELECT nombre FROM departamento ORDER BY nombre DESC;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/14.png" alt="pregunta 14">
                </div>
            
                <div class="step">
                    <h3>15. Lista los apellidos y el nombre de todos los empleados, ordenados de forma alfabética</h3>
                    <pre><code>SELECT apePaterno, apeMaterno, nombre FROM empleado ORDER BY apePaterno, apeMaterno, nombre;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/15.png" alt="pregunta 15">
                </div>
            
                <div class="step">
                    <h3>16. Devuelve una lista con el nombre y el presupuesto de los 3 departamentos que tienen mayor presupuesto</h3>
                    <pre><code>SELECT TOP 3 nombre, presupuesto FROM departamento ORDER BY presupuesto DESC;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/16.png" alt="pregunta 16">
                </div>
            
                <div class="step">
                    <h3>17. Devuelve una lista con el nombre y el presupuesto de los 3 departamentos que tienen menor presupuesto</h3>
                    <pre><code>SELECT TOP 3 nombre, presupuesto FROM departamento ORDER BY presupuesto ASC;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/17.png" alt="pregunta 17">
                </div>
            
                <div class="step">
                    <h3>18. Devuelve una lista con el nombre y el gasto, de los 2 departamentos que tienen mayor gasto</h3>
                    <pre><code>SELECT TOP 2 nombre, gastos FROM departamento ORDER BY gastos DESC;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/18.png" alt="pregunta 18">
                </div>
            
                <div class="step">
                    <h3>19. Devuelve una lista con el nombre y el gasto, de los 2 departamentos que tienen menor gasto</h3>
                    <pre><code>SELECT TOP 2 nombre, gastos FROM departamento ORDER BY gastos ASC;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/19.png" alt="pregunta 19">
                </div>
            
                <div class="step">
                    <h3>20. Devuelve una lista con 5 filas a partir de la tercera fila de la tabla empleado</h3>
                    <pre><code>SELECT * FROM empleado ORDER BY codigo OFFSET 2 ROWS FETCH NEXT 5 ROWS ONLY;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/20.png" alt="pregunta 20">
                </div>
            
                <div class="step">
                    <h3>21. Devuelve una lista con el nombre de los departamentos y el presupuesto de aquellos que tienen un presupuesto mayor o igual a 150000 euros</h3>
                    <pre><code>SELECT nombre, presupuesto FROM departamento WHERE presupuesto >= 150000;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/21.png" alt="pregunta 21">
                </div>
            
                <div class="step">
                    <h3>22. Devuelve una lista con el nombre de los departamentos y el gasto de aquellos que tienen menos de 5000 euros de gastos</h3>
                    <pre><code>SELECT nombre, gastos FROM departamento WHERE gastos < 5000;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/22.png" alt="pregunta 22">
                </div>
            
                <div class="step">
                    <h3>23. Devuelve una lista con el nombre de los departamentos y el presupuesto de aquellos que tienen un presupuesto entre 100000 y 200000 euros, sin utilizar el operador BETWEEN</h3>
                    <pre><code>SELECT nombre, presupuesto FROM departamento WHERE presupuesto >= 100000 AND presupuesto <= 200000;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/23.png" alt="pregunta 23">
                </div>
            
                <div class="step">
                    <h3>24. Devuelve una lista con el nombre de los departamentos que no tienen un presupuesto entre 100000 y 200000 euros, sin utilizar el operador BETWEEN</h3>
                    <pre><code>SELECT nombre, presupuesto FROM departamento WHERE presupuesto < 100000 OR presupuesto > 200000;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/24.png" alt="pregunta 24">
                </div>
            
                <div class="step">
                    <h3>25. Devuelve una lista con el nombre de los departamentos que tienen un presupuesto entre 100000 y 200000 euros, utilizando el operador BETWEEN</h3>
                    <pre><code>SELECT nombre, presupuesto FROM departamento WHERE presupuesto BETWEEN 100000 AND 200000;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/25.png" alt="pregunta 25">
                </div>

                <div class="step">
                    <h3>26. Devuelve una lista con el nombre de los departamentos que no tienen un presupuesto entre 100000 y 200000 euros, utilizando el operador BETWEEN</h3>
                    <pre><code>SELECT nombre, presupuesto FROM departamento WHERE presupuesto NOT BETWEEN 100000 AND 200000;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/26.png" alt="pregunta 26">
                </div>
            
                <div class="step">
                    <h3>27. Devuelve una lista con el nombre de los departamentos, gastos y presupuesto, de aquellos departamentos donde los gastos sean mayores que el presupuesto del que disponen.</h3>
                    <pre><code>SELECT nombre, gastos, presupuesto FROM departamento WHERE gastos > presupuesto;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/27.png" alt="pregunta 27">
                </div>
            
                <div class="step">
                    <h3>28. Devuelve una lista con el nombre de los departamentos, gastos y presupuesto, de aquellos departamentos donde los gastos sean menores que el presupuesto del que disponen.</h3>
                    <pre><code>SELECT nombre, gastos, presupuesto FROM departamento WHERE gastos < presupuesto;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/28.png" alt="pregunta 28">
                </div>
            
                <div class="step">
                    <h3>29. Devuelve una lista con el nombre de los departamentos, gastos y presupuesto, de aquellos departamentos donde los gastos sean iguales al presupuesto del que disponen.</h3>
                    <pre><code>SELECT nombre, gastos, presupuesto FROM departamento WHERE gastos = presupuesto;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/29.png" alt="pregunta 29">
                </div>
            
                <div class="step">
                    <h3>30. Lista todos los datos de los empleados cuyo segundo apellido (apeMaterno) sea NULL.</h3>
                    <pre><code>SELECT * FROM empleado WHERE apeMaterno IS NULL;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/30.png" alt="pregunta 30">
                </div>
            
                <div class="step">
                    <h3>31. Lista todos los datos de los empleados cuyo segundo apellido (apeMaterno) no sea NULL.</h3>
                    <pre><code>SELECT * FROM empleado WHERE apeMaterno IS NOT NULL;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/31.png" alt="pregunta 31">
                </div>
            
                <div class="step">
                    <h3>32. Lista todos los datos de los empleados cuyo segundo apellido (apeMaterno) sea López.</h3>
                    <pre><code>SELECT * FROM empleado WHERE apeMaterno = 'López';</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/32.png" alt="pregunta 32">
                </div>
            
                <div class="step">
                    <h3>33. Lista todos los datos de los empleados cuyo segundo apellido (apeMaterno) sea Díaz o Moreno, sin utilizar el operador IN.</h3>
                    <pre><code>SELECT * FROM empleado WHERE apeMaterno = 'Díaz' OR apeMaterno = 'Moreno';</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/33.png" alt="pregunta 33">
                </div>
            
                <div class="step">
                    <h3>34. Lista todos los datos de los empleados cuyo segundo apellido (apeMaterno) sea Díaz o Moreno, utilizando el operador IN.</h3>
                    <pre><code>SELECT * FROM empleado WHERE apeMaterno IN ('Díaz', 'Moreno');</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/34.png" alt="pregunta 34">
                </div>
            
                <div class="step">
                    <h3>35. Lista los nombres, apellidos y DNI de los empleados que trabajan en el departamento 3.</h3>
                    <pre><code>SELECT nombre, apePaterno, apeMaterno, dni FROM empleado WHERE codigo_departamento = 3;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/35.png" alt="pregunta 35">
                </div>
            
                <div class="step">
                    <h3>36. Lista los nombres, apellidos y DNI de los empleados que trabajan en los departamentos 2, 4 o 5.</h3>
                    <pre><code>SELECT nombre, apePaterno, apeMaterno, dni FROM empleado WHERE codigo_departamento IN (2, 4, 5);</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas/36.png" alt="pregunta 36">
                </div>
            </div>
        
            <!-- tipo Consultas multitablas (composición externa) --> 
            <div id="ConsultasExterna" class="guide-section">
                <h2>Consultas multitablas (composición externa)</h2>
                <div class="step">
                    <h3>1. Devuelve un listado con todos los empleados junto con los datos de los departamentos donde trabajan. Este listado también debe incluir los empleados que no tienen ningún departamento asociado</h3>
                    <pre><code>SELECT CONCAT(e.nombre, ' ', e.apePaterno, ' ', e.apeMaterno) AS NombreCompleto, d.nombre AS Departamento, d.presupuesto, d.gastos FROM empleado e LEFT JOIN departamento d ON e.codigo_departamento = d.codigo;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas multitablas (composición externa)/1.png" alt="pregunta 1">
                </div>
            
                <div class="step">
                    <h3>2. Devuelve un listado donde sólo aparezcan aquellos empleados que no tienen ningún departamento asociado</h3>
                    <pre><code>SELECT CONCAT(e.nombre, ' ', e.apePaterno, ' ', e.apeMaterno) AS NombreCompleto FROM empleado e LEFT JOIN departamento d ON e.codigo_departamento = d.codigo WHERE e.codigo_departamento IS NULL;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas multitablas (composición externa)/2.png" alt="pregunta 2">
                </div>
            
                <div class="step">
                    <h3>3. Devuelve un listado donde sólo aparezcan aquellos departamentos que no tienen ningún empleado asociado</h3>
                    <pre><code>SELECT d.nombre AS Departamento FROM departamento d LEFT JOIN empleado e ON d.codigo = e.codigo_departamento WHERE e.codigo_departamento IS NULL;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas multitablas (composición externa)/3.png" alt="pregunta 3">
                </div>
            
                <div class="step">
                    <h3>4. Devuelve un listado con todos los empleados junto con los datos de los departamentos donde trabajan. El listado debe incluir los empleados que no tienen ningún departamento asociado y los departamentos que no tienen ningún empleado asociado. Ordene el listado alfabéticamente por el nombre del departamento</h3>
                    <pre><code>SELECT CONCAT(e.nombre, ' ', e.apePaterno, ' ', e.apeMaterno) AS NombreCompleto, d.nombre AS Departamento, d.presupuesto, d.gastos FROM empleado e FULL OUTER JOIN departamento d ON e.codigo_departamento = d.codigo ORDER BY d.nombre;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas multitablas (composición externa)/4.png" alt="pregunta 4">
                </div>
            
                <div class="step">
                    <h3>5. Devuelve un listado con los empleados que no tienen ningún departamento asociado y los departamentos que no tienen ningún empleado asociado. Ordene el listado alfabéticamente por el nombre del departamento</h3>
                    <pre><code>SELECT CONCAT(e.nombre, ' ', e.apePaterno, ' ', e.apeMaterno) AS NombreCompleto, d.nombre AS Departamento FROM empleado e FULL OUTER JOIN departamento d ON e.codigo_departamento = d.codigo WHERE e.codigo_departamento IS NULL OR d.codigo IS NULL ORDER BY d.nombre;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas multitablas (composición externa)/5.png" alt="pregunta 5">
                </div>
            </div>
        
            <!-- tipo Consultas multitablas (composición interna) --> 
            <div id="ConsultasInterna" class="guide-section">
                <h2>Consultas multitablas (composición interna)</h2>
                <div class="step">
                    <h3>1. Listado con los empleados (nombre completo) y el nombre del departamento donde trabaja cada uno</h3>
                    <pre><code>SELECT CONCAT(empleado.nombre, ' ', empleado.apePaterno, ' ', empleado.apeMaterno) AS NombreCompleto, departamento.nombre AS Departamento FROM empleado JOIN departamento ON empleado.codigo_departamento = departamento.codigo;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas multitablas (composición interna)/1.png" alt="pregunta 1">
                </div>
            
                <div class="step">
                    <h3>2. Listado con los empleados (nombre completo) y los datos de los departamentos donde trabaja cada uno, ordenado por departamento y luego por apellidos y nombre</h3>
                    <pre><code>SELECT CONCAT(empleado.apePaterno, ' ', empleado.apeMaterno, ' ', empleado.nombre) AS NombreCompleto, departamento.nombre AS Departamento FROM empleado JOIN departamento ON empleado.codigo_departamento = departamento.codigo ORDER BY departamento.nombre ASC, empleado.apePaterno ASC, empleado.apeMaterno ASC, empleado.nombre ASC;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas multitablas (composición interna)/2.png" alt="pregunta 2">
                </div>

                <div class="step">
                    <h3>3. Listado con el código y el nombre del departamento, solamente de aquellos departamentos que tienen empleados</h3>
                    <pre><code>SELECT DISTINCT departamento.codigo, departamento.nombre FROM empleado JOIN departamento ON empleado.codigo_departamento = departamento.codigo;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas multitablas (composición interna)/3.png" alt="pregunta 3">
                </div>
            
                <div class="step">
                    <h3>4. Listado con el código, el nombre del departamento y el valor del presupuesto actual, de aquellos departamentos que tienen empleados</h3>
                    <pre><code>SELECT departamento.codigo, departamento.nombre, (departamento.presupuesto - departamento.gastos) AS PresupuestoActual FROM empleado JOIN departamento ON empleado.codigo_departamento = departamento.codigo;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas multitablas (composición interna)/4.png" alt="pregunta 4">
                </div>
            
                <div class="step">
                    <h3>5. Nombre del departamento donde trabaja el empleado que tiene el nif '3883298M'</h3>
                    <pre><code>SELECT departamento.nombre AS Departamento FROM empleado JOIN departamento ON empleado.codigo_departamento = departamento.codigo WHERE empleado.dni = '3883298M';</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas multitablas (composición interna)/5.png" alt="pregunta 5">
                </div>
            
                <div class="step">
                    <h3>6. Nombre del departamento donde trabaja el empleado 'Pepe Ruiz Santana'</h3>
                    <pre><code>SELECT departamento.nombre AS Departamento FROM empleado JOIN departamento ON empleado.codigo_departamento = departamento.codigo WHERE empleado.nombre = 'Pepe' AND empleado.apePaterno = 'Ruiz' AND empleado.apeMaterno = 'Santana';</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas multitablas (composición interna)/6.png" alt="pregunta 6">
                </div>
            
                <div class="step">
                    <h3>7. Listado de los empleados (nombre completo) que trabajan en el departamento de 'I+D', ordenado alfabéticamente</h3>
                    <pre><code>SELECT CONCAT(empleado.nombre, ' ', empleado.apePaterno, ' ', empleado.apeMaterno) AS NombreCompleto FROM empleado JOIN departamento ON empleado.codigo_departamento = departamento.codigo WHERE departamento.nombre = 'I+D' ORDER BY empleado.apePaterno ASC, empleado.apeMaterno ASC, empleado.nombre ASC;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas multitablas (composición interna)/7.png" alt="pregunta 7">
                </div>
            
                <div class="step">
                    <h3>8. Listado de los empleados (nombre completo) que trabajan en los departamentos de 'Sistemas', 'Contabilidad' o 'I+D', ordenado alfabéticamente</h3>
                    <pre><code>SELECT CONCAT(empleado.nombre, ' ', empleado.apePaterno, ' ', empleado.apeMaterno) AS NombreCompleto FROM empleado JOIN departamento ON empleado.codigo_departamento = departamento.codigo WHERE departamento.nombre IN ('Sistemas', 'Contabilidad', 'I+D') ORDER BY empleado.apePaterno ASC, empleado.apeMaterno ASC, empleado.nombre ASC;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas multitablas (composición interna)/8.png" alt="pregunta 8">
                </div>
            
                <div class="step">
                    <h3>9. Lista con el nombre de los empleados (nombre completo) que tienen los departamentos que no tienen un presupuesto entre 100000 y 200000 euros</h3>
                    <pre><code>SELECT CONCAT(empleado.nombre, ' ', empleado.apePaterno, ' ', empleado.apeMaterno) AS NombreCompleto FROM empleado JOIN departamento ON empleado.codigo_departamento = departamento.codigo WHERE departamento.presupuesto NOT BETWEEN 100000 AND 200000;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas multitablas (composición interna)/9.png" alt="pregunta 9">
                </div>
            
                <div class="step">
                    <h3>10. Devuelve un listado con el nombre de los departamentos donde existe algún empleado cuyo segundo apellido sea NULL. Ten en cuenta que no debe mostrar nombres de departamentos que estén repetidos</h3>
                    <pre><code>SELECT DISTINCT d.nombre AS Departamento FROM empleado e JOIN departamento d ON e.codigo_departamento = d.codigo WHERE e.apeMaterno IS NULL;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas multitablas (composición interna)/10.png" alt="pregunta 10">
                </div>
            </div>
        
            <!-- tipo Consultas resumen --> 
            <div id="ConsultasResumen" class="guide-section">
                <h2>Consultas resumen</h2>
                <div class="step">
                    <h3>1. Calcula la suma del presupuesto de todos los departamentos</h3>
                    <pre><code>SELECT SUM(presupuesto) AS total_presupuesto FROM departamento;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas resumen/1.png" alt="pregunta 1">
                </div>
            
                <div class="step">
                    <h3>2. Calcula la media del presupuesto de todos los departamentos</h3>
                    <pre><code>SELECT AVG(presupuesto) AS promedio_presupuesto FROM departamento;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas resumen/2.png" alt="pregunta 2">
                </div>
            
                <div class="step">
                    <h3>3. Calcula el valor mínimo del presupuesto de todos los departamentos</h3>
                    <pre><code>SELECT MIN(presupuesto) AS min_presupuesto FROM departamento;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas resumen/3.png" alt="pregunta 3">
                </div>
            
                <div class="step">
                    <h3>4. Calcula el nombre del departamento y el presupuesto que tiene asignado, del departamento con menor presupuesto</h3>
                    <pre><code>SELECT nombre, presupuesto FROM departamento WHERE presupuesto = (SELECT MIN(presupuesto) FROM departamento);</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas resumen/4.png" alt="pregunta 4">
                </div>
            
                <div class="step">
                    <h3>5. Calcula el valor máximo del presupuesto de todos los departamentos</h3>
                    <pre><code>SELECT MAX(presupuesto) AS max_presupuesto FROM departamento;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas resumen/5.png" alt="pregunta 5">
                </div>
            
                <div class="step">
                    <h3>6. Calcula el nombre del departamento y el presupuesto que tiene asignado, del departamento con mayor presupuesto</h3>
                    <pre><code>SELECT nombre, presupuesto FROM departamento WHERE presupuesto = (SELECT MAX(presupuesto) FROM departamento);</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas resumen/6.png" alt="pregunta 6">
                </div>
            
                <div class="step">
                    <h3>7. Calcula el número total de empleados que hay en la tabla empleado</h3>
                    <pre><code>SELECT COUNT(*) AS total_empleados FROM empleado;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas resumen/7.png" alt="pregunta 7">
                </div>
            
                <div class="step">
                    <h3>8. Calcula el número de empleados que no tienen NULL en su segundo apellido</h3>
                    <pre><code>SELECT COUNT(*) AS total_empleados_sin_null_apeMaterno FROM empleado WHERE apeMaterno IS NOT NULL;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas resumen/8.png" alt="pregunta 8">
                </div>
            
                <div class="step">
                    <h3>9. Calcula el número de empleados que hay en cada departamento. Devuelve dos columnas: el nombre del departamento y el número de empleados</h3>
                    <pre><code>SELECT d.nombre, COUNT(e.codigo) AS total_empleados FROM departamento d LEFT JOIN empleado e ON d.codigo = e.codigo_departamento GROUP BY d.nombre;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas resumen/9.png" alt="pregunta 9">
                </div>
            
                <div class="step">
                    <h3>10. Calcula el nombre de los departamentos que tienen más de 2 empleados</h3>
                    <pre><code>SELECT d.nombre FROM departamento d LEFT JOIN empleado e ON d.codigo = e.codigo_departamento GROUP BY d.nombre HAVING COUNT(e.codigo) > 2;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas resumen/10.png" alt="pregunta 10">
                </div>
            
                <div class="step">
                    <h3>11. Calcula el nombre del departamento y el número de empleados en departamentos que no tienen empleados asignados, ni departamentos asociados a empleados</h3>
                    <pre><code>SELECT d.nombre,
                        COUNT(e.codigo) AS total_empleados
                        FROM departamento d
                        LEFT JOIN empleado e ON d.codigo = e.codigo_departamento
                        WHERE e.codigo IS NULL GROUP BY d.nombre;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas resumen/11.png" alt="pregunta 11">
                </div>
            
                <div class="step">
                    <h3>12. Calcula el número de empleados que trabajan en cada uno de los departamentos que tienen un presupuesto mayor a 200000 euros</h3>
                    <pre><code>SELECT d.nombre
                        AS Departamento,
                        COUNT(e.codigo)
                        AS NumeroEmpleados
                        FROM departamento d
                        JOIN empleado e
                        ON d.codigo = e.codigo_departamento
                        WHERE d.presupuesto > 200000 GROUP
                        BY d.nombre;</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Consultas resumen/12.png" alt="pregunta 12">
                </div>
            </div>
        
            <!-- tipo Subconsultas --> 
            <div id="Subconsultas" class="guide-section">
                <h2>Subconsultas</h2>

                <!-- CON OPERADORES BÁSICOS DE COMPARACIÓN -->
                <h3>Con operadores básicos de comparación</h3>

                <div class="step">
                    <h3>1. Devuelve un listado con todos los empleados que tiene el departamento de Sistemas. (Sin utilizar INNER JOIN)</h3>
                    <pre><code>SELECT CONCAT(e.nombre, ' ', e.apePaterno, ' ', e.apeMaterno)
                        AS NombreCompleto
                        FROM empleado e, departamento d
                        WHERE e.codigo_departamento = d.codigo
                        AND d.nombre = 'Sistemas';</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Subconsultas/1.png" alt="pregunta 1">
                </div>

                <div class="step">
                    <h3>2. Devuelve el nombre del departamento con mayor presupuesto y la cantidad que tiene asignada</h3>
                    <pre><code>SELECT d.nombre AS Departamento, d.presupuesto FROM departamento d WHERE d.presupuesto = (SELECT MAX(presupuesto) FROM departamento);</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Subconsultas/2.png" alt="pregunta 2">
                </div>

                <div class="step">
                    <h3>3. Devuelve el nombre del departamento con menor presupuesto y la cantidad que tiene asignada</h3>
                    <pre><code>SELECT d.nombre AS Departamento, d.presupuesto FROM departamento d WHERE d.presupuesto = (SELECT MIN(presupuesto) FROM departamento);</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Subconsultas/3.png" alt="pregunta 3">
                </div>

                <!-- SUBCONSULTAS CON ALL Y ANY -->
                <h3>Subconsultas con ALL y ANY</h3>

                <div class="step">
                    <h3>1. Devuelve el nombre del departamento con mayor presupuesto y la cantidad que tiene asignada. Sin hacer uso de MAX, ORDER BY ni LIMIT</h3>
                    <pre><code>SELECT d.nombre AS Departamento, d.presupuesto FROM departamento d WHERE d.presupuesto >= ALL (SELECT presupuesto FROM departamento);</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Subconsultas/4.png" alt="pregunta 4">
                </div>

                <div class="step">
                    <h3>2. Devuelve el nombre del departamento con menor presupuesto y la cantidad que tiene asignada. Sin hacer uso de MIN, ORDER BY ni LIMIT</h3>
                    <pre><code>SELECT d.nombre AS Departamento, d.presupuesto FROM departamento d WHERE d.presupuesto <= ALL (SELECT presupuesto FROM departamento);</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Subconsultas/5.png" alt="pregunta 5">
                </div>

                <div class="step">
                    <h3>3. Devuelve los nombres de los departamentos que tienen empleados asociados. (Utilizando ALL o ANY)</h3>
                    <pre><code>SELECT DISTINCT d.nombre AS Departamento FROM departamento d WHERE d.codigo = ANY (SELECT e.codigo_departamento FROM empleado e);</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Subconsultas/6.png" alt="pregunta 6">
                </div>

                <div class="step">
                    <h3>4. Devuelve los nombres de los departamentos que no tienen empleados asociados. (Utilizando ALL o ANY)</h3>
                    <pre><code>SELECT DISTINCT d.nombre AS Departamento FROM departamento d WHERE d.codigo != ALL (SELECT e.codigo_departamento FROM empleado e);</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Subconsultas/7.png" alt="pregunta 7">
                </div>

                <!-- SUBCONSULTAS CON IN Y NOT IN -->
                <h3>Subconsultas con IN y NOT IN</h3>

                <div class="step">
                    <h3>1. Devuelve los nombres de los departamentos que tienen empleados asociados. (Utilizando IN o NOT IN)</h3>
                    <pre><code>SELECT DISTINCT d.nombre AS Departamento FROM departamento d WHERE d.codigo IN (SELECT e.codigo_departamento FROM empleado e);</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Subconsultas/8.png" alt="pregunta 8">
                </div>

                <div class="step">
                    <h3>2. Devuelve los nombres de los departamentos que no tienen empleados asociados. (Utilizando IN o NOT IN)</h3>
                    <pre><code>SELECT DISTINCT d.nombre AS Departamento FROM departamento d WHERE d.codigo NOT IN (SELECT e.codigo_departamento FROM empleado e);</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Subconsultas/9.png" alt="pregunta 9">
                </div>

                <!-- SUBCONSULTAS CON EXISTS Y NOT EXISTS -->
                <h3>Subconsultas con EXISTS y NOT EXISTS</h3>

                <div class="step">
                    <h3>1. Devuelve los nombres de los departamentos que tienen empleados asociados. (Utilizando EXISTS o NOT EXISTS)</h3>
                    <pre><code>SELECT DISTINCT d.nombre AS Departamento FROM departamento d WHERE EXISTS (SELECT 1 FROM empleado e WHERE e.codigo_departamento = d.codigo);</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Subconsultas/10.png" alt="pregunta 10">
                </div>

                <div class="step">
                    <h3>2. Devuelve los nombres de los departamentos que no tienen empleados asociados. (Utilizando EXISTS o NOT EXISTS)</h3>
                    <pre><code>SELECT DISTINCT d.nombre AS Departamento FROM departamento d WHERE NOT EXISTS (SELECT 1 FROM empleado e WHERE e.codigo_departamento = d.codigo);</code></pre>
                    <img src="../imagenes/semana 6 consultas avanzadas/Subconsultas/11.png" alt="pregunta 11">
                </div>

            </div>
        </main>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const consultasBtn = document.getElementById('ConsultasBtn');
            const consultasExternaBtn = document.getElementById('ConsultasExternaBtn');
            const consultasInternaBtn = document.getElementById('ConsultasInternaBtn');
            const consultasResumenBtn = document.getElementById('ConsultasResumenBtn');
            const subconsultasBtn = document.getElementById('SubconsultasBtn');
            
            const consultasSection = document.getElementById('Consultas');
            const consultasExternaSection = document.getElementById('ConsultasExterna');
            const consultasInternaSection = document.getElementById('ConsultasInterna');
            const consultasResumenSection = document.getElementById('ConsultasResumen');
            const subconsultasSection = document.getElementById('Subconsultas');
            
            const guideButtons = document.querySelectorAll('.guide-btn');
            const guideSections = document.querySelectorAll('.guide-section');
    
            function showSection(section) {
                guideSections.forEach(sec => sec.classList.remove('active'));
                section.classList.add('active');
            }
    
            consultasBtn.addEventListener('click', function() {
                showSection(consultasSection);
                setActiveButton(consultasBtn);
            });
    
            consultasExternaBtn.addEventListener('click', function() {
                showSection(consultasExternaSection);
                setActiveButton(consultasExternaBtn);
            });
    
            consultasInternaBtn.addEventListener('click', function() {
                showSection(consultasInternaSection);
                setActiveButton(consultasInternaBtn);
            });
    
            consultasResumenBtn.addEventListener('click', function() {
                showSection(consultasResumenSection);
                setActiveButton(consultasResumenBtn);
            });
    
            subconsultasBtn.addEventListener('click', function() {
                showSection(subconsultasSection);
                setActiveButton(subconsultasBtn);
            });
    
            function setActiveButton(activeBtn) {
                guideButtons.forEach(btn => btn.classList.remove('active'));
                activeBtn.classList.add('active');
            }
        });
    </script>
     <!-- Fin del contenedor general -->
</body>
</html>
